#!/bin/bash

function log()
{
  FLG_1=${1}
  FLG_2=${2}
  if [[ ${FLG_1} == "-l" || ${FLG_1} == "-lv" || ${FLG_1} == "-lvs" ]]; then
    if [[ ${FLG_2} != "" ]]; then
      if [[ ${FLG_1} == "-l" && ${STACK_LOG} == 1 ]]; then
        echo "  ${FLG_2}"
      elif [[ ${FLG_1} == "-lv" && ${STACK_LOG_VERBOSE} == 1 ]]; then
        echo "    ${FLG_2}"
      elif [[ ${FLG_1} == "-lvs" && ${STACK_LOG_VERBOSE_SUPPER} == 1 ]]; then
        echo "      ${FLG_2}"
      fi
    fi
  elif [[ ${FLG_1} != "" ]]; then
    echo ${FLG_1}
  fi
}

function prepare()
{
  echo $(mkdir -p ${BUILD_DIR})>/dev/null
  echo $(mkdir -p ${BUILD_APP_DIR})>/dev/null
}

function run()
{
  RUN_FILE=${STACK_BIN_DIR}/prepare-${APPLICATION_STACK}.env
  if [[ -f ${RUN_FILE} ]]; then
    source ${RUN_FILE};
  fi

  RUN_FILE=${STACK_APPLICATION_BIN_DIR}/run-deploy-yml
  source ${RUN_FILE}
}

function main()
{
  prepare
  run
}

main